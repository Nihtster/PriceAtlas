CREATE SCHEMA PRICEATLAS;
USE PRICEATLAS;


CREATE TABLE GAME (
	GameID      INT NOT NULL UNIQUE,
	Title       VARCHAR(64) NOT NULL,
	ReleaseDate DATE NOT NULL,
	Developer   VARCHAR(32) NOT NULL,
	CONSTRAINT GAME_PK PRIMARY KEY(GameID)
);


CREATE TABLE ITEM (
	RefGameID       INT NOT NULL,
	ItemID          INT NOT NULL UNIQUE,
	ItemName        VARCHAR(64) NOT NULL,
	ItemType        VARCHAR(32) NOT NULL,
	ItemDescription VARCHAR(255),
	CONSTRAINT ITEM_FK_GID FOREIGN KEY(RefGameID) REFERENCES GAME(GameID)
													ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT ITEM_PK PRIMARY KEY(ItemID)
);


CREATE TABLE STATCONTAINER (
	ContainerID INT NOT NULL UNIQUE,
	RefItemID INT NOT NULL,
	CONSTRAINT STATC_FK_ITEMID FOREIGN KEY(RefItemID) REFERENCES ITEM(ItemID)
													ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT STATC_PK PRIMARY KEY(ContainerID)
);


CREATE TABLE STATS (
	RefContainerID INT NOT NULL,
	StatID INT NOT NULL AUTO_INCREMENT UNIQUE,
	StatName VARCHAR(16) NOT NULL,
	StatValue FLOAT NOT NULL,
	CONSTRAINT STATS_FK_ITEMID FOREIGN KEY(RefContainerID) REFERENCES STATCONTAINER(ContainerID)
													ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT STATS_PK PRIMARY KEY(StatID, RefContainerID)
);
CREATE TABLE PRICE (
	PriceLocation VARCHAR(32) NOT NULL,
	Stock INT NOT NULL,
	Cost FLOAT NOT NULL,
	CurrencyType VARCHAR(3) NOT NULL,
	PriceContainerID INT NOT NULL,
	CONSTRAINT PRICE_FK_ITEMID FOREIGN KEY(PriceContainerID) REFERENCES STATCONTAINER(ContainerID)
													ON DELETE CASCADE ON UPDATE CASCADE,
	CONSTRAINT PRICE_PK PRIMARY KEY(PriceLocation, PriceContainerID)
);
